<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Window Sandwich Layers</title>
    <style>
      body {
        margin: 0;
        background: #f0f0f0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        /**/
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        min-height: 100vh;
        background: #f0f0f0 url("assets/animation/3d/ear/bg-galaxy.jpg") center
          center no-repeat fixed;
        background-size: cover;
        display: flex;
        justify-content: center;
        align-items: center;
        position: relative;
      }
      #container {
        position: relative;
        width: 500px;
        height: 500px;
        perspective: 800px;
      }
      .layer {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        transform-style: preserve-3d;
        transition: transform 0.3s ease;
        pointer-events: none; /* makes mouse tracking smooth */
      }
      .layer img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        opacity: 0.85;
        display: block;
      }
    </style>
  </head>
  <body>
    <div id="container">
      <div id="layer-1" class="layer" data-depth="0.02">
        <img
          width="100%"
          height="auto"
          src="assets/animation/3d/ear/ear-2-base-1.png"
        />
      </div>
      <div id="layer-2" class="layer" data-depth="0.04">
        <img
          width="100%"
          height="auto"
          src="assets/animation/3d/ear/ear-2-base-1.png"
        />
      </div>
      <div id="layer-3" class="layer" data-depth="0.06">
        <img
          width="100%"
          height="auto"
          src="assets/animation/3d/ear/ear-2-base-2.png"
        />
      </div>
      <div id="layer-4" class="layer" data-depth="0.08">
        <img
          width="100%"
          height="auto"
          src="assets/animation/3d/ear/ear-2-detail-1.png"
        />
      </div>
      <div id="layer-5" class="layer" data-depth="0.10">
        <img
          width="100%"
          height="auto"
          src="assets/animation/3d/ear/ear-2-detail-2.png"
        />
      </div>
    </div>

    <script type="module">
      const container = document.getElementById("container");
      const layers = Array.from(container.querySelectorAll(".layer"));

      container.addEventListener("mouseenter", () =>
        container.addEventListener("mousemove", onMouseMove)
      );

      container.addEventListener("mouseleave", () => {
        layers.forEach((l) => (l.style.transform = `translate(0px, 0px)`));
        container.removeEventListener("mousemove", onMouseMove);
      });

      function onMouseMove(e) {
        const { left, top, width, height } = container.getBoundingClientRect();
        const xRel = (e.clientX - left) / width - 0.7;
        const yRel = (e.clientY - top) / height - 0.7;
        layers.forEach((l) => {
          const depth = parseFloat(l.dataset.depth);
          const xShift = -(xRel * depth * width);
          const yShift = -(yRel * depth * height);
          l.style.transform = `translate(${xShift}px, ${yShift}px)`;
        });
      }
    </script>
  </body>
</html>
